(this.webpackJsonpinstagram=this.webpackJsonpinstagram||[]).push([[5],{276:function(e,t,s){"use strict";s.d(t,"a",(function(){return c})),s.d(t,"e",(function(){return r})),s.d(t,"d",(function(){return a})),s.d(t,"c",(function(){return o})),s.d(t,"j",(function(){return l})),s.d(t,"i",(function(){return i})),s.d(t,"b",(function(){return d})),s.d(t,"f",(function(){return u})),s.d(t,"g",(function(){return m})),s.d(t,"h",(function(){return j}));var n=s(49);async function c(e){return(await n.b.firestore().collection("users").where("username","==",e.toLowerCase()).get()).docs.length>0}async function r(e){return(await n.b.firestore().collection("users").where("username","==",e.toLowerCase()).get()).docs.map((e=>({...e.data(),docId:e.id})))}async function a(e){return(await n.b.firestore().collection("users").where("userId","==",e).get()).docs.map((e=>({...e.data(),docId:e.id})))}async function o(e,t){let s=n.b.firestore().collection("users");s=t.length>0?s.where("userId","not-in",[...t,e]):s.where("userId","!=",e);return(await s.limit(10).get()).docs.map((e=>({...e.data(),docId:e.id})))}async function l(e,t,s){return n.b.firestore().collection("users").doc(e).update({following:s?n.a.arrayRemove(t):n.a.arrayUnion(t)})}async function i(e,t,s){return n.b.firestore().collection("users").doc(e).update({followers:s?n.a.arrayRemove(t):n.a.arrayUnion(t)})}async function d(e,t){const s=(await n.b.firestore().collection("photos").where("userId","in",t).get()).docs.map((e=>({...e.data(),docId:e.id})));return await Promise.all(s.map((async t=>{let s=!1;t.likes.includes(e)&&(s=!0);const n=await a(t.userId),{username:c}=n[0];return{username:c,...t,userLikedPhoto:s}})))}async function u(e){return(await n.b.firestore().collection("photos").where("userId","==",e).get()).docs.map((e=>({...e.data(),docId:e.id})))}async function m(e,t){const s=await n.b.firestore().collection("users").where("username","==",e).where("following","array-contains",t).get(),[c={}]=s.docs.map((e=>({...e.data(),docId:e.id})));return c.userId}async function j(e,t,s,n,c){await l(t,n,e),await i(s,c,e)}},279:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));const n="./images/avatars/default.png"},280:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s(1),c=s(276);function r(e){const[t,s]=Object(n.useState)();return Object(n.useEffect)((()=>{e&&async function(e){const[t]=await Object(c.d)(e);s(t||{})}(e)}),[e]),{user:t,setActiveUser:s}}},281:function(e,t,s){"use strict";var n=s(1);const c=Object(n.createContext)(null);t.a=c},286:function(e,t,s){"use strict";s.d(t,"a",(function(){return m}));var n=s(1),c=s(9),r=s(48),a=s(42),o=s(76),l=s(24),i=s(279),d=s(280),u=s(6);function m(){const{user:e}=Object(n.useContext)(o.a),{user:t}=Object(d.a)(null===e||void 0===e?void 0:e.uid),{firebase:s}=Object(n.useContext)(a.a),m=Object(c.g)();return Object(u.jsx)("header",{className:"h-16 bg-white border-b border-gray-primary mb-8",children:Object(u.jsx)("div",{className:"container mx-auto max-w-screen-lg h-full",children:Object(u.jsxs)("div",{className:"flex justify-between h-full",children:[Object(u.jsx)("div",{className:"text-gray-700 text-center flex items-center align-items cursor-pointer",children:Object(u.jsx)("h1",{className:"flex justify-center w-full",children:Object(u.jsx)(r.b,{to:l.a,"aria-label":"Instagram logo",children:Object(u.jsx)("img",{src:"./images/logo.png",alt:"Instagram",className:"mt-2 w-6/12"})})})}),Object(u.jsx)("div",{className:"text-gray-700 text-center flex items-center align-items",children:e?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(r.b,{to:l.a,"aria-label":"Dashboard",children:Object(u.jsx)("svg",{className:"w-8 mr-6 text-black-light cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),Object(u.jsx)("button",{type:"button",title:"Sign Out",onClick:()=>{s.auth().signOut(),m.push(l.b)},onKeyDown:e=>{"Enter"===e.key&&(s.auth().signOut(),m.push(l.b))},children:Object(u.jsx)("svg",{className:"w-8 mr-6 text-black-light cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})}),t&&Object(u.jsx)("div",{className:"flex items-center cursor-pointer",children:Object(u.jsx)(r.b,{to:"/p/".concat(null===t||void 0===t?void 0:t.username),children:Object(u.jsx)("img",{className:"rounded-full h-8 w-8 flex",src:"./images/avatars/".concat(null===t||void 0===t?void 0:t.username,".jpg"),alt:"".concat(null===t||void 0===t?void 0:t.username," profile"),onError:e=>{e.target.src=i.a}})})})]}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(r.b,{to:l.b,children:Object(u.jsx)("button",{type:"button",className:"bg-blue-medium font-bold text-sm rounded text-white w-20 h-8",children:"Log In"})}),Object(u.jsx)(r.b,{to:l.e,children:Object(u.jsx)("button",{type:"button",className:"font-bold text-sm rounded text-blue-medium w-20 h-8",children:"Sign Up"})})]})})]})})})}},311:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return L}));var n=s(1),c=s(286),r=s(287),a=s.n(r),o=s(281),l=s(276);var i=s(48),d=s(6);function u(e){let{username:t}=e;return Object(d.jsx)("div",{className:"flex border-b border-gray-primary h-4 p-4 py-8",children:Object(d.jsx)("div",{className:"flex items-center",children:Object(d.jsxs)(i.b,{to:"/p/".concat(t),className:"flex items-center",children:[Object(d.jsx)("img",{className:"rounded-full h-8 w-8 flex mr-3",src:"./images/avatars/".concat(t,".jpg"),alt:"".concat(t," profile picture")}),Object(d.jsx)("p",{className:"font-bold",children:t})]})})})}function m(e){let{src:t,caption:s}=e;return Object(d.jsx)("img",{src:t,alt:s})}var j=s(42),b=s(76);function x(e){let{docId:t,totalLikes:s,likedPhoto:c,handleFocus:r}=e;const{user:{uid:a}}=Object(n.useContext)(b.a),[o,l]=Object(n.useState)(c),[i,u]=Object(n.useState)(s),{firebase:m,FieldValue:x}=Object(n.useContext)(j.a),f=async()=>{l((e=>!e)),await m.firestore().collection("photos").doc(t).update({likes:o?x.arrayRemove(a):x.arrayUnion(a)}),u((e=>o?e-1:e+1))};return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{className:"flex justify-between p-4",children:Object(d.jsxs)("div",{className:"flex",children:[Object(d.jsx)("svg",{onClick:f,onKeyDown:e=>{"Enter"===e.key&&f()},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,className:"w-8 mr-4 select-none cursor-pointer focus:outline-none ".concat(o?"fill-red text-red-primary":"text-black-light"),children:Object(d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),Object(d.jsx)("svg",{onClick:r,onKeyDown:e=>{"Enter"===e.key&&r()},className:"w-8 text-black-light select-none cursor-pointer focus:outline-none",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,children:Object(d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})]})}),Object(d.jsx)("div",{className:"p-4 py-0",children:Object(d.jsx)("p",{className:"font-bold",children:"".concat(i,1===i?" like":" likes")})})]})}function f(e){let{caption:t,username:s}=e;return Object(d.jsxs)("div",{className:"p-4 pt-2 pb-1",children:[Object(d.jsx)("span",{className:"mr-1 font-bold",children:s}),Object(d.jsx)("span",{className:"italic",children:t})]})}var h=s(310);function p(e){let{docId:t,comments:s,setComments:c,commentInput:r}=e;const[a,o]=Object(n.useState)(""),{firebase:l,FieldValue:i}=Object(n.useContext)(j.a),{user:{displayName:u}}=Object(n.useContext)(b.a),m=e=>(e.preventDefault(),c([...s,{displayName:u,comment:a}]),o(""),l.firestore().collection("photos").doc(t).update({comments:i.arrayUnion({displayName:u,comment:a})}));return Object(d.jsx)("div",{className:"border-t border-gray-primary",children:Object(d.jsxs)("form",{className:"flex justify-between pl-0 pr-5",method:"POST",onSubmit:e=>a.length>=1?m(e):e.preventDefault(),children:[Object(d.jsx)("input",{"aria-label":"Add a comment",autoComplete:"off",className:"text-sm text-gray-base w-full mr-3 py-5 px-4",type:"text",name:"add-comment",placeholder:"Add a comment...",value:a,onChange:e=>{let{target:t}=e;return o(t.value)},ref:r}),Object(d.jsx)("button",{className:"text-sm font-bold text-blue-medium ".concat(!a&&"opacity-25"),type:"button",disabled:a.length<1,onClick:m,children:"Post"})]})})}function O(e){let{docId:t,comments:s,posted:c,commentInput:r}=e;const[a,o]=Object(n.useState)(s),[l,u]=Object(n.useState)(3),m=()=>{u(l+3)};return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"p-4 pt-1 pb-4",children:[a.slice(0,l).map((e=>Object(d.jsxs)("p",{className:"mb-1",children:[Object(d.jsx)(i.b,{to:"/p/".concat(e.displayName),children:Object(d.jsx)("span",{className:"mr-1 font-bold",children:e.displayName})}),Object(d.jsx)("span",{children:e.comment})]},"".concat(e.comment,"-").concat(e.displayName)))),a.length>=3&&l<a.length&&Object(d.jsx)("button",{className:"text-sm text-gray-base mb-1 cursor-pointer focus:outline-none",type:"button",onClick:m,onKeyDown:e=>{"Enter"===e.key&&m()},children:"View more comments"}),Object(d.jsxs)("p",{className:"text-gray-base uppercase text-xs mt-2",children:[Object(h.a)(c,new Date)," ago"]})]}),Object(d.jsx)(p,{docId:t,comments:a,setComments:o,commentInput:r})]})}function g(e){let{content:t}=e;const s=Object(n.useRef)(null);return Object(d.jsxs)("div",{className:"rounded col-span-4 border bg-white border-gray-primary mb-12",children:[Object(d.jsx)(u,{username:t.username}),Object(d.jsx)(m,{src:t.imageSrc,caption:t.caption}),Object(d.jsx)(x,{docId:t.docId,totalLikes:t.likes.length,likedPhoto:t.userLikedPhoto,handleFocus:()=>s.current.focus()}),Object(d.jsx)(f,{caption:t.caption,username:t.username}),Object(d.jsx)(O,{docId:t.docId,comments:t.comments,posted:t.dateCreated,commentInput:s})]})}function w(){const{user:e}=Object(n.useContext)(o.a),{user:{following:t}={}}=Object(n.useContext)(o.a),{photos:s}=function(e){const[t,s]=Object(n.useState)(null);return Object(n.useEffect)((()=>{!async function(){var t;if((null===e||void 0===e||null===(t=e.following)||void 0===t?void 0:t.length)>0){const t=await Object(l.b)(e.userId,e.following);t.sort(((e,t)=>t.dateCreated-e.dateCreated)),s(t)}}()}),[null===e||void 0===e?void 0:e.userId,null===e||void 0===e?void 0:e.following]),{photos:t}}(e);return Object(d.jsx)("div",{className:"container col-span-2",children:void 0===t?Object(d.jsx)(a.a,{count:2,width:640,height:500,className:"mb-5"}):0===t.length?Object(d.jsx)("p",{className:"flex justify-center font-bold",children:"Follow other people to see Photos"}):s?s.map((e=>Object(d.jsx)(g,{content:e},e.docId))):null})}var v=s(279);function y(e){let{username:t,fullName:s}=e;return t&&s?Object(d.jsxs)(i.b,{to:"/p/".concat(t),className:"grid grid-cols-4 gap-4 mb-6 items-center",children:[Object(d.jsx)("div",{className:"flex items-center justify-between col-span-1",children:Object(d.jsx)("img",{className:"rounded-full w-16 flex mr-3",src:"./images/avatars/".concat(t,".jpg"),alt:"",onError:e=>{e.target.src=v.a}})}),Object(d.jsxs)("div",{className:"col-span-3",children:[Object(d.jsx)("p",{className:"font-bold text-sm",children:t}),Object(d.jsx)("p",{className:"text-sm",children:s})]})]}):Object(d.jsx)(a.a,{count:1,height:61})}function N(e){let{profileDocId:t,username:s,profileId:c,userId:r,loggedInUserDocId:a}=e;const[u,m]=Object(n.useState)(!1),{setActiveUser:j}=Object(n.useContext)(o.a);return u?null:Object(d.jsxs)("div",{className:"flex flex-row items-center align-items justify-between",children:[Object(d.jsxs)("div",{className:"flex items-center justify-between",children:[Object(d.jsx)("img",{className:"rounded-full w-8 flex mr-3",src:"./images/avatars/".concat(s,".jpg"),alt:"",onError:e=>{e.target.src="./images/avatars/default.png"}}),Object(d.jsx)(i.b,{to:"/p/".concat(s),children:Object(d.jsx)("p",{className:"font-bold text-sm",children:s})})]}),Object(d.jsx)("button",{className:"text-xs font-bold text-blue-medium",type:"button",onClick:async function(){m(!0),await Object(l.j)(a,c,!1),await Object(l.i)(t,r,!1);const[e]=await Object(l.d)(r);j(e)},children:"Follow"})]})}function I(e){let{userId:t,following:s,loggedInUserDocId:c}=e;const[r,o]=Object(n.useState)(null);return Object(n.useEffect)((()=>{t&&async function(){const e=await Object(l.c)(t,s);o(e)}()}),[t]),r?r.length>0?Object(d.jsxs)("div",{className:"rounded flex flex-col",children:[Object(d.jsx)("div",{className:"text-sm flex items-center align-items justify-between mb-2",children:Object(d.jsx)("p",{className:"font-bold text-gray-base",children:"Suggestions for you"})}),Object(d.jsx)("div",{className:"mt-4 grid gap-5",children:r.map((e=>Object(d.jsx)(N,{profileDocId:e.docId,username:e.username,profileId:e.userId,userId:t,loggedInUserDocId:c},e.docId)))})]}):null:Object(d.jsx)(a.a,{count:1,height:150,className:"mt-5"})}function k(){const{user:{docId:e="",fullName:t,username:s,userId:c,following:r}={}}=Object(n.useContext)(o.a);return Object(d.jsxs)("div",{className:"p-4",children:[Object(d.jsx)(y,{username:s,fullName:t}),Object(d.jsx)(I,{userId:c,following:r,loggedInUserDocId:e})]})}var C=s(280);function L(e){let{user:t}=e;const{user:s,setActiveUser:r}=Object(C.a)(t.uid);return Object(n.useEffect)((()=>{document.title="Instagram"}),[]),Object(d.jsx)(o.a.Provider,{value:{user:s,setActiveUser:r},children:Object(d.jsxs)("div",{className:"bg-gray-background",children:[Object(d.jsx)(c.a,{}),Object(d.jsxs)("div",{className:"grid grid-cols-3 gap-4 justify-between mx-auto max-w-screen-lg",children:[Object(d.jsx)(w,{}),Object(d.jsx)(k,{})]})]})})}}}]);
//# sourceMappingURL=5.c31c2033.chunk.js.map