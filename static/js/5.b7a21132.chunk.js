(this.webpackJsonpinstagram=this.webpackJsonpinstagram||[]).push([[5],{276:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"j",(function(){return i})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return j}));var s=n(49);async function c(e){return(await s.b.firestore().collection("users").where("username","==",e.toLowerCase()).get()).docs.length>0}async function r(e){return(await s.b.firestore().collection("users").where("username","==",e.toLowerCase()).get()).docs.map((e=>({...e.data(),docId:e.id})))}async function a(e){return(await s.b.firestore().collection("users").where("userId","==",e).get()).docs.map((e=>({...e.data(),docId:e.id})))}async function o(e,t){let n=s.b.firestore().collection("users");n=t.length>0?n.where("userId","not-in",[...t,e]):n.where("userId","!=",e);return(await n.limit(10).get()).docs.map((e=>({...e.data(),docId:e.id})))}async function i(e,t,n){return s.b.firestore().collection("users").doc(e).update({following:n?s.a.arrayRemove(t):s.a.arrayUnion(t)})}async function l(e,t,n){return s.b.firestore().collection("users").doc(e).update({followers:n?s.a.arrayRemove(t):s.a.arrayUnion(t)})}async function d(e,t){const n=(await s.b.firestore().collection("photos").where("userId","in",t).get()).docs.map((e=>({...e.data(),docId:e.id})));return await Promise.all(n.map((async t=>{let n=!1;t.likes.includes(e)&&(n=!0);const s=await a(t.userId),{username:c}=s[0];return{username:c,...t,userLikedPhoto:n}})))}async function u(e){return(await s.b.firestore().collection("photos").where("userId","==",e).get()).docs.map((e=>({...e.data(),docId:e.id})))}async function m(e,t){const n=await s.b.firestore().collection("users").where("username","==",e).where("following","array-contains",t).get(),[c={}]=n.docs.map((e=>({...e.data(),docId:e.id})));return c.userId}async function j(e,t,n,s,c){await i(t,s,e),await l(n,c,e)}},279:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(1);function c(){const{innerWidth:e,innerHeight:t}=window;return{width:e,height:t}}function r(){const[e,t]=Object(s.useState)(c());return Object(s.useEffect)((()=>{function e(){t(c())}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e}},280:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const s="./images/avatars/default.png"},281:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(1),c=n(276);function r(e){const[t,n]=Object(s.useState)();return Object(s.useEffect)((()=>{e&&async function(e){const[t]=await Object(c.d)(e);n(t||{})}(e)}),[e]),{user:t,setActiveUser:n}}},282:function(e,t,n){"use strict";var s=n(1);const c=Object(s.createContext)(null);t.a=c},287:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var s=n(1),c=n(9),r=n(48),a=n(42),o=n(76),i=n(24),l=n(280),d=n(281),u=n(6);function m(){const{user:e}=Object(s.useContext)(o.a),{user:t}=Object(d.a)(null===e||void 0===e?void 0:e.uid),{firebase:n}=Object(s.useContext)(a.a),m=Object(c.g)();return Object(u.jsx)("header",{className:"h-16 bg-white border-b border-gray-primary mb-8",children:Object(u.jsx)("div",{className:"container mx-auto max-w-screen-lg h-full",children:Object(u.jsxs)("div",{className:"flex justify-between h-full",children:[Object(u.jsx)("div",{className:"text-gray-700 text-center flex items-center align-items cursor-pointer",children:Object(u.jsx)("h1",{className:"flex justify-center w-full",children:Object(u.jsx)(r.b,{to:i.a,"aria-label":"Instagram logo",children:Object(u.jsx)("img",{src:"./images/logo.png",alt:"Instagram",className:"mt-2 w-6/12"})})})}),Object(u.jsx)("div",{className:"text-gray-700 text-center flex items-center align-items",children:e?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(r.b,{to:i.a,"aria-label":"Dashboard",children:Object(u.jsx)("svg",{className:"w-8 mr-6 text-black-light cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}),Object(u.jsx)("button",{type:"button",title:"Sign Out",onClick:()=>{n.auth().signOut(),m.push(i.b)},onKeyDown:e=>{"Enter"===e.key&&(n.auth().signOut(),m.push(i.b))},children:Object(u.jsx)("svg",{className:"w-8 mr-6 text-black-light cursor-pointer",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Object(u.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})}),t&&Object(u.jsx)("div",{className:"flex items-center cursor-pointer",children:Object(u.jsx)(r.b,{to:"/p/".concat(null===t||void 0===t?void 0:t.username),children:Object(u.jsx)("img",{className:"rounded-full h-8 w-8 flex",src:"./images/avatars/".concat(null===t||void 0===t?void 0:t.username,".jpg"),alt:"".concat(null===t||void 0===t?void 0:t.username," profile"),onError:e=>{e.target.src=l.a}})})})]}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(r.b,{to:i.b,children:Object(u.jsx)("button",{type:"button",className:"bg-blue-medium font-bold text-sm rounded text-white w-20 h-8",children:"Log In"})}),Object(u.jsx)(r.b,{to:i.e,children:Object(u.jsx)("button",{type:"button",className:"font-bold text-sm rounded text-blue-medium w-20 h-8",children:"Sign Up"})})]})})]})})})}},312:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var s=n(1),c=n(287),r=n(288),a=n.n(r),o=n(282),i=n(276);var l=n(48),d=n(6);function u(e){let{username:t}=e;return Object(d.jsx)("div",{className:"flex border-b border-gray-primary h-4 p-4 py-8",children:Object(d.jsx)("div",{className:"flex items-center",children:Object(d.jsxs)(l.b,{to:"/p/".concat(t),className:"flex items-center",children:[Object(d.jsx)("img",{className:"rounded-full h-8 w-8 flex mr-3",src:"./images/avatars/".concat(t,".jpg"),alt:"".concat(t," profile picture")}),Object(d.jsx)("p",{className:"font-bold",children:t})]})})})}function m(e){let{src:t,caption:n}=e;return Object(d.jsx)("img",{src:t,alt:n})}var j=n(42),b=n(76);function f(e){let{docId:t,totalLikes:n,likedPhoto:c,handleFocus:r}=e;const{user:{uid:a}}=Object(s.useContext)(b.a),[o,i]=Object(s.useState)(c),[l,u]=Object(s.useState)(n),{firebase:m,FieldValue:f}=Object(s.useContext)(j.a),x=async()=>{i((e=>!e)),await m.firestore().collection("photos").doc(t).update({likes:o?f.arrayRemove(a):f.arrayUnion(a)}),u((e=>o?e-1:e+1))};return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("div",{className:"flex justify-between p-4",children:Object(d.jsxs)("div",{className:"flex",children:[Object(d.jsx)("svg",{onClick:x,onKeyDown:e=>{"Enter"===e.key&&x()},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,className:"w-8 mr-4 select-none cursor-pointer focus:outline-none ".concat(o?"fill-red text-red-primary":"text-black-light"),children:Object(d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),Object(d.jsx)("svg",{onClick:r,onKeyDown:e=>{"Enter"===e.key&&r()},className:"w-8 text-black-light select-none cursor-pointer focus:outline-none",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",tabIndex:0,children:Object(d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})})]})}),Object(d.jsx)("div",{className:"p-4 py-0",children:Object(d.jsx)("p",{className:"font-bold",children:"".concat(l,1===l?" like":" likes")})})]})}function x(e){let{caption:t,username:n}=e;return Object(d.jsxs)("div",{className:"p-4 pt-2 pb-1",children:[Object(d.jsx)("span",{className:"mr-1 font-bold",children:n}),Object(d.jsx)("span",{className:"italic",children:t})]})}var h=n(311);function p(e){let{docId:t,comments:n,setComments:c,commentInput:r}=e;const[a,o]=Object(s.useState)(""),{firebase:i,FieldValue:l}=Object(s.useContext)(j.a),{user:{displayName:u}}=Object(s.useContext)(b.a),m=e=>(e.preventDefault(),c([...n,{displayName:u,comment:a}]),o(""),i.firestore().collection("photos").doc(t).update({comments:l.arrayUnion({displayName:u,comment:a})}));return Object(d.jsx)("div",{className:"border-t border-gray-primary",children:Object(d.jsxs)("form",{className:"flex justify-between pl-0 pr-5",method:"POST",onSubmit:e=>a.length>=1?m(e):e.preventDefault(),children:[Object(d.jsx)("input",{"aria-label":"Add a comment",autoComplete:"off",className:"text-sm text-gray-base w-full mr-3 py-5 px-4",type:"text",name:"add-comment",placeholder:"Add a comment...",value:a,onChange:e=>{let{target:t}=e;return o(t.value)},ref:r}),Object(d.jsx)("button",{className:"text-sm font-bold text-blue-medium ".concat(!a&&"opacity-25"),type:"button",disabled:a.length<1,onClick:m,children:"Post"})]})})}function g(e){let{docId:t,comments:n,posted:c,commentInput:r}=e;const[a,o]=Object(s.useState)(n),[i,u]=Object(s.useState)(3),m=()=>{u(i+3)};return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"p-4 pt-1 pb-4",children:[a.slice(0,i).map((e=>Object(d.jsxs)("p",{className:"mb-1",children:[Object(d.jsx)(l.b,{to:"/p/".concat(e.displayName),children:Object(d.jsx)("span",{className:"mr-1 font-bold",children:e.displayName})}),Object(d.jsx)("span",{children:e.comment})]},"".concat(e.comment,"-").concat(e.displayName)))),a.length>=3&&i<a.length&&Object(d.jsx)("button",{className:"text-sm text-gray-base mb-1 cursor-pointer focus:outline-none",type:"button",onClick:m,onKeyDown:e=>{"Enter"===e.key&&m()},children:"View more comments"}),Object(d.jsxs)("p",{className:"text-gray-base uppercase text-xs mt-2",children:[Object(h.a)(c,new Date)," ago"]})]}),Object(d.jsx)(p,{docId:t,comments:a,setComments:o,commentInput:r})]})}function O(e){let{content:t}=e;const n=Object(s.useRef)(null);return Object(d.jsxs)("div",{className:"rounded col-span-4 border bg-white border-gray-primary mb-12",children:[Object(d.jsx)(u,{username:t.username}),Object(d.jsx)(m,{src:t.imageSrc,caption:t.caption}),Object(d.jsx)(f,{docId:t.docId,totalLikes:t.likes.length,likedPhoto:t.userLikedPhoto,handleFocus:()=>n.current.focus()}),Object(d.jsx)(x,{caption:t.caption,username:t.username}),Object(d.jsx)(g,{docId:t.docId,comments:t.comments,posted:t.dateCreated,commentInput:n})]})}function w(){const{user:e}=Object(s.useContext)(o.a),{user:{following:t}={}}=Object(s.useContext)(o.a),{photos:n}=function(e){const[t,n]=Object(s.useState)(null);return Object(s.useEffect)((()=>{!async function(){var t;if((null===e||void 0===e||null===(t=e.following)||void 0===t?void 0:t.length)>0){const t=await Object(i.b)(e.userId,e.following);t.sort(((e,t)=>t.dateCreated-e.dateCreated)),n(t)}}()}),[null===e||void 0===e?void 0:e.userId,null===e||void 0===e?void 0:e.following]),{photos:t}}(e);return Object(d.jsx)("div",{className:"container col-span-2",children:void 0===t?Object(d.jsx)(a.a,{count:2,width:640,height:500,className:"mb-5"}):0===t.length?Object(d.jsx)("p",{className:"flex justify-center font-bold",children:"Follow other people to see Photos"}):n?n.map((e=>Object(d.jsx)(O,{content:e},e.docId))):null})}var v=n(280);function y(e){let{username:t,fullName:n}=e;return t&&n?Object(d.jsxs)(l.b,{to:"/p/".concat(t),className:"grid grid-cols-4 gap-4 mb-6 items-center",children:[Object(d.jsx)("div",{className:"flex items-center justify-between col-span-1",children:Object(d.jsx)("img",{className:"rounded-full w-16 flex mr-3",src:"./images/avatars/".concat(t,".jpg"),alt:"",onError:e=>{e.target.src=v.a}})}),Object(d.jsxs)("div",{className:"col-span-3",children:[Object(d.jsx)("p",{className:"font-bold text-sm",children:t}),Object(d.jsx)("p",{className:"text-sm",children:n})]})]}):Object(d.jsx)(a.a,{count:1,height:61})}function N(e){let{profileDocId:t,username:n,profileId:c,userId:r,loggedInUserDocId:a}=e;const[u,m]=Object(s.useState)(!1),{setActiveUser:j}=Object(s.useContext)(o.a);return u?null:Object(d.jsxs)("div",{className:"flex flex-row items-center align-items justify-between",children:[Object(d.jsxs)("div",{className:"flex items-center justify-between",children:[Object(d.jsx)("img",{className:"rounded-full w-8 flex mr-3",src:"./images/avatars/".concat(n,".jpg"),alt:"",onError:e=>{e.target.src="./images/avatars/default.png"}}),Object(d.jsx)(l.b,{to:"/p/".concat(n),children:Object(d.jsx)("p",{className:"font-bold text-sm",children:n})})]}),Object(d.jsx)("button",{className:"text-xs font-bold text-blue-medium",type:"button",onClick:async function(){m(!0),await Object(i.j)(a,c,!1),await Object(i.i)(t,r,!1);const[e]=await Object(i.d)(r);j(e)},children:"Follow"})]})}function I(e){let{userId:t,following:n,loggedInUserDocId:c}=e;const[r,o]=Object(s.useState)(null);return Object(s.useEffect)((()=>{t&&async function(){const e=await Object(i.c)(t,n);o(e)}()}),[t]),r?r.length>0?Object(d.jsxs)("div",{className:"rounded flex flex-col",children:[Object(d.jsx)("div",{className:"text-sm flex items-center align-items justify-between mb-2",children:Object(d.jsx)("p",{className:"font-bold text-gray-base",children:"Suggestions for you"})}),Object(d.jsx)("div",{className:"mt-4 grid gap-5",children:r.map((e=>Object(d.jsx)(N,{profileDocId:e.docId,username:e.username,profileId:e.userId,userId:t,loggedInUserDocId:c},e.docId)))})]}):null:Object(d.jsx)(a.a,{count:1,height:150,className:"mt-5"})}function k(){const{user:{docId:e="",fullName:t,username:n,userId:c,following:r}={}}=Object(s.useContext)(o.a);return Object(d.jsxs)("div",{className:"p-4",children:[Object(d.jsx)(y,{username:n,fullName:t}),Object(d.jsx)(I,{userId:c,following:r,loggedInUserDocId:e})]})}var C=n(281),L=n(279);function S(e){let{user:t}=e;const{height:n,width:r}=Object(L.a)(),{user:a,setActiveUser:i}=Object(C.a)(t.uid);return Object(s.useEffect)((()=>{document.title="Instagram"}),[]),Object(d.jsx)(o.a.Provider,{value:{user:a,setActiveUser:i},children:Object(d.jsxs)("div",{className:"bg-gray-background",children:[Object(d.jsx)(c.a,{}),Object(d.jsxs)("div",{className:"grid grid-cols-1 col-span-1 p-6 sm:p-16 lg:p-2 m-auto \r lg:grid-cols-3 gap-4 md:justify-between justify-center mx-auto max-w-screen-lg",children:[Object(d.jsx)(w,{}),r>1e3?Object(d.jsx)(k,{}):null]})]})})}}}]);
//# sourceMappingURL=5.b7a21132.chunk.js.map